{% extends "base.html" %}
{% load widget_tweaks static %}

{% block title %}Editar perfil — SQM Brasil{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto bg-white border rounded-2xl p-6">
  <h1 class="text-2xl font-semibold mb-4">Editar perfil</h1>

  <form method="post" class="space-y-6">
    {% csrf_token %}

    <div>
      <label class="block text-sm font-medium mb-2">Nome de usuário</label>
      {{ form.username|add_class:"w-full border rounded-md p-2" }}
      {% if form.username.errors %}
        <ul class="mt-1 text-xs text-red-600">
          {% for e in form.username.errors %}
            <li>{{ e }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    </div>

    <div>
      <label class="block text-sm font-medium mb-2">Escolha seu avatar</label>

      <div class="grid grid-cols-3 sm:grid-cols-3 gap-4">
        {% for value, label in form.avatar_choice.field.choices %}
          {% with is_checked=form.avatar_choice.value == value %}
          <label class="cursor-pointer flex flex-col items-center gap-2 p-3 border rounded-lg hover:bg-gray-50 {% if is_checked %}ring-2 ring-brand{% endif %}">
            <img src="{% static value %}" alt="{{ label }}" class="h-16 w-16 rounded-full border object-cover">
            <input type="radio" name="{{ form.avatar_choice.name }}" value="{{ value }}" class="hidden" {% if is_checked %}checked{% endif %}>
            <span class="text-xs text-gray-600">{{ label }}</span>
          </label>
          {% endwith %}
        {% endfor %}
      </div>

      {% if form.avatar_choice.errors %}
        <ul class="mt-1 text-xs text-red-600">
          {% for e in form.avatar_choice.errors %}
            <li>{{ e }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    </div>

    <div>
      <label class="block text-sm font-medium mb-1">Bio</label>
      {{ form.bio|add_class:"w-full border rounded-md p-2" }}
      <p class="text-xs text-gray-500 mt-1">Dica: fale brevemente sobre sua experiência com SQM.</p>
    </div>

    <div class="pt-2">
      <button class="px-4 py-2 bg-brand text-white rounded-md hover:bg-brand-dark">Salvar</button>
      <a href="{% url 'profile' request.user.username %}" class="ml-2 px-4 py-2 border rounded-md hover:bg-gray-50">Cancelar</a>
    </div>
  </form>
</div>
{% endblock %}
